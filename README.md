# NodeLib
## Назначение – 
NodeLib – это Библиотека классов, предоставляющая классы для работы с графами (Graph, Node, Edge)
## Описание принципа работы – 
Принцип работы библиотеки прост – пользователь (программист, использующий библиотеку) пользуется предоставленными ему классами, а внутри себя экземпляр классов (объекты) фиксируют происходящие изменения и, при необходимости, формируют команду на изменение состояния графа. Команда помещается в специальную потокобезопасную очередь.
Для каждого графа запускается обработчик очереди команд, изменения текущего графа. Обработчик работает в отдельном потоке, пока не активирован CancelationToken. Обработчик экономит ресурсы компьютера и работает только тогда, когда в очереди есть элементы.
При вызове метода Dispose у графа активируется CancelationToken, и после обработки всей очереди команд очищаются ресурсы занимаемые графом.
### Описание классов программы - 
#### Graph – класс представляющий граф сам по себе, позволяет создавать, получать по id и удалять узлы текущего графа. Также именно класс Graph содержит в себе логику обработку очереди команд (команд изменения состояния графа)
Описание класса:
##### поля и свойства – 
- ConcurrentQueue<Command> _queue - очередь комманд
- List<Node> _nodePool – список всех узлов графа
- HttpClient _httpClient – объект http клиента для отправки запросов
- string _senderEndpoint – url принимающего сервера (TransltionServer)
- Guid _managerId- Id NodeManager`а
- Task _queueHandlerTask- ссылка на задачу обработки очереди (для работы с многопоточкой)
- CancellationTokenSource cancellationTokenSource - cancelation token
##### Методы – 
- Dispose() – метод для освобождения неуправляемых ресурсов, реализуем интерфейс IDisposable
- Graph() – конструктор класса, выполняет инициализацию объекта класса:
- генерирует уникальный id объекта 
- создаёт список узлов класса
- устанавливает адрес принимающего сервера – senderEndpoint
- создаёт объект httpClient для отправки http запросов
- создаёт cancellationToken
- запускает в другом потоке метод QueueProcessingAsync, для обработки очереди команд
- CreateNode() – метод создания нового узла графа, возвращает новый объект класса Node
- GetNodeById() – метод получения узла по его идентификатору
- DeleteNode – метод удаления узла из графа
- QueueProcessingAsync() – метод обработки очереди команд, запускается в отдельном потоке и выполняет обработку очереди команд
- SendCommandAsync() – метод отправки команды на TranslationServer, вызывается только в методе QueueProcessingAsync

#### Node – класс представляющий узел графа сам по себе, позволяет работать с узлами графа, изменять их свойства, создавать, получать, изменять и удалять рёбра графа (связи с другими узлами графа)
Описание класса:
##### Поля и свойства – 
- ConcurrentQueue<Command>? Queue – ссылка на очередь команд
- public Guid Id - Id узла
- List<Edge> outputEdges - список дочерних узлов (ссылок на дочерние узлы)
- List<Edge> inputEdges - список входящих узлов
- ReadOnlyCollection<Edge> Childs - свойство (извне список дочерних элементов изменить нельзя)
- string Name – имя узла
- string Color - цвет
- double Size - размер
- bool Selected – факт выделенности
- int Visited – факт посещения (может быть числом – количеством посещений)
- object Value – хранимое значение (опционально)
##### Методы – 
- AddChild() – метод добавление дочернего элемента для текущего узла, создаёт связь (ребро) с узлом
- DeleteChild() – метод удаления дочернего узла, выполняет удаление связи (ребра) с узлом
- GetChild() – получение узла по идентификатору
- DeleteAllInputEdges() – метод удаляющий все входящие связи (рёбра)
- DeleteAllOutputEdges() – метод удаляющий все исходящие связи (рёбра)
- Delete() – метод выполняющий подготовку к удалению узла, вызывает методы DeleteAllInputEdges и DeleteAllOutputEdges
- Node() – конструктор выполняющий инициализацию объекта
- Equals() – переопределение метода Equals() для сравнения объектов
- operator ==  - определение оператора == для узла
- operator != - определение опреатора != для узла

#### Edge – класс представляющий ребро графа само по себе, реализует связи между узлами графа, а также может хранить полезную информацию о самом ребре
#### CommandType – перечисление типов команд
#### Command - класс, представляющий команду, содержит уникальный идентификатор, тип команды (CommandType) и некоторый передаваемый объект-значение
#### RpcRequect – класс описывающий запрос к TranslationServer, содержит в себе информацию о команде и дополнительные данные
#### RpcResponse – класс описывающий ответ от TranslationServer

